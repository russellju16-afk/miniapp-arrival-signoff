<view class="container">
  <view class="card actions">
    <button class="btn-plain action-btn" bindtap="goProducts">继续下单</button>
    <button class="btn-plain action-btn" bindtap="goCart">购物车</button>
  </view>

  <view class="card">
    <view class="label">状态筛选</view>
    <picker mode="selector" range="{{statusOptions}}" range-key="label" value="{{statusIndex}}" bindchange="onStatusChange">
      <view class="picker">当前：{{statusOptions[statusIndex].label}}</view>
    </picker>

    <view class="search-row">
      <input
        class="search-input"
        placeholder="按订单号搜索"
        value="{{keyword}}"
        bindinput="onKeywordInput"
        bindconfirm="onSearch"
        confirm-type="search"
      />
      <button class="btn-primary search-btn" bindtap="onSearch">搜索</button>
      <button class="btn-plain search-btn" bindtap="onClearKeyword">清空</button>
    </view>
  </view>

  <block wx:if="{{loading && list.length === 0}}">
    <view class="empty">加载中...</view>
  </block>

  <block wx:elif="{{list.length === 0}}">
    <view class="empty">暂无订单</view>
  </block>

  <block wx:else>
    <view class="card item" wx:for="{{list}}" wx:key="id" data-id="{{item.id}}" bindtap="goDetail">
      <view class="row">
        <text class="title">{{item.orderNo}}</text>
        <text class="status">{{item.status}}</text>
      </view>
      <view class="row">
        <text class="label">总金额</text>
        <text class="price">¥{{item.totalAmountText}}</text>
      </view>
      <view class="sub-title">金蝶单号：{{item.kingdeeOrderNumber || '-'}}</view>
      <view class="sub-title">下单时间：{{item.createdAtText}}</view>
      <view class="sub-title" wx:if="{{item.writebackError}}">写回错误：{{item.writebackError}}</view>
      <view class="more">查看详情 ></view>
    </view>

    <view class="empty" wx:if="{{loading}}">正在加载更多...</view>
    <view class="empty" wx:elif="{{!hasMore}}">没有更多订单了</view>
  </block>
</view>
